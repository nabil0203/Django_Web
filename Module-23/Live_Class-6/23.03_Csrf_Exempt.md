# CSRF Exempt VS CSRF Token

## CSRF Token (What it does)
- Django generates a unique token per user session
- The token is included in HTML forms
- Django verifies the token on every POST / PUT / DELETE request

Example
```html
<form method="POST">
    {% csrf_token %}
    <button type="submit">Submit</button>
</form>
```

- ‚úÖ If token matches ‚Üí request allowed
- ‚ùå If missing/invalid ‚Üí 403 Forbidden

- Use CSRF Token When:
    - User submits forms
    - Admin panels
    - Dashboards
    - Authenticated browser actions


----



# CSRF Exempt
- Tells Django to skip CSRF validation for a specific view
Example
```py
from django.views.decorators.csrf import csrf_exempt

@csrf_exempt
def webhook(request):
    if request.method == "POST":
        return HttpResponse("OK")

```
- Use CSRF Exempt When:
    - External APIs call your backend
    - Mobile apps (no cookies/session)
    - Payment gateways & webhooks
    - Machine-to-machine communication

>‚ö†Ô∏è Danger --> Any site can hit this endpoint ‚Äî no CSRF check.

## üéØ Key Difference (One-Line)
- CSRF Token protects your app from forged browser requests
- CSRF Exempt removes that protection completely for a specific view.



-----------------------------------
-----------------------------------

# üî®CSRF Use in project

### 1Ô∏è‚É£ `views.py`
- Import
```py
from django.views.decorators.csrf import csrf_exempt
```

- Use in the relevant views
```py
@csrf_exempt
@login_required
def payment_fail(request, order_id):
    order = get_object_or_404(models.Order, id = order_id, user=request.user)

    order.status = 'canceled'

    order.save()
    return redirect('checkout')
```